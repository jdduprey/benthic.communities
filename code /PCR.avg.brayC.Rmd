---
title: "PCR.avg.brayC"
author: "Joe Duprey"
date: "10/8/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(dplyr)
library(vegan)
```

## Data Exploration and Visualization 
## Working Towards Research Question for HC/SJ Data

psuedocode 
later) get read avgs, this time accounting for the fact that there are 2 PCR reps
and 3 PCR reps

1) calculate eDNA index, then calculate BC dissimilarity

2) recreate basic boxplots of bethic communities, maybe look into the insect
data that Ryan keeps mentioning

3) Bray Curtis and Jaccard heatmaps could be interesting 

4) In another script: recreating Moncho's k-means analysis -> this begins at line 369 of manuscript.main.analysis

```{r}
eDNAindex <- read.csv("../data/eDNAindex.avg.reps.csv")

eDNAindex.PA <- eDNAindex %>%
  select(sample, species, eDNA_index) %>%
  pivot_wider(names_from=sample, values_from=eDNA_index, values_fill=list(eDNA_index=0))

eDNAindex.PA <- eDNAindex.PA %>%  
  pivot_longer(!species, names_to='sample', values_to='eDNA_index') 

# why does NA show up here
Index.check.PA <- eDNAindex.PA %>% 
  group_by(species) %>% 
  summarize(max(eDNA_index),
            min(eDNA_index))

Index.check <- eDNAindex %>%
  group_by(species) %>% 
  summarize(max(eDNA_index),
            min(eDNA_index))
```

## Including Plots

```{r}
data(varespec)

# wide data to match vegdist() example above data(varespec) --looking good so far 10/8/2021
wide.eDNA.index <- eDNAindex.PA %>%
  pivot_wider(names_from = species, values_from =eDNA_index)

# save sample names as vector
sample_sites <- wide.eDNA.index$sample

# get rid of sample names so we can use vegdist()
wide.eDNA.index <- wide.eDNA.index %>%
  select(-sample)

# calculate parewise dissimilarities - next step reproduce figure in emily's tides paper! 
dist.matrix <- vegdist(wide.eDNA.index, method='bray')
```

